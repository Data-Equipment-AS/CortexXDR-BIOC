dc184989e143ec9ded3aedeccfb27b6e
[{"rule_id":489,"global_rule_id":"NO_ID","mssp_global_rule_id":null,"insert_time":1625470742422,"modify_time":1629288150285,"severity":"SEV_020_LOW","source":"filip.fog@dataequipment.no","comment":"","status":"ENABLED","category":"EXECUTION","indicator":{"runOnCGO":true,"investigationType":"PROCESS_EXECUTION_EVENT","investigation":{"PROCESS_EXECUTION_EVENT":{"filter":{"AND":[{"SEARCH_FIELD":"agent_os_type","SEARCH_TYPE":"NEQ","SEARCH_VALUE":4,"EXTRA_FIELDS":[],"isExtended":false,"node":"xdr_agent"},{"SEARCH_FIELD":"action_process_signature_status","SEARCH_TYPE":"COMPLEX_EQ","SEARCH_VALUE":"{\"COLLECTION_TYPE\": \"SIGNATURE_STATUS\", \"COLLECTION_VALUE\": \"SIGNATURE_UNSIGNED\"}","EXTRA_FIELDS":[],"isExtended":false,"node":"attributes"},{"OR":[{"SEARCH_FIELD":"actor_process_signature_status","SEARCH_TYPE":"COMPLEX_EQ","SEARCH_VALUE":"{\"COLLECTION_TYPE\": \"SIGNATURE_STATUS\", \"COLLECTION_VALUE\": \"SIGNATURE_SIGNED\"}","EXTRA_FIELDS":["causality_actor_process_signature_status","os_actor_process_signature_status"],"isExtended":false,"node":"xdr_actor"},{"SEARCH_FIELD":"causality_actor_process_signature_status","SEARCH_TYPE":"COMPLEX_EQ","SEARCH_VALUE":"{\"COLLECTION_TYPE\": \"SIGNATURE_STATUS\", \"COLLECTION_VALUE\": \"SIGNATURE_SIGNED\"}","isExtended":true,"node":"xdr_actor"},{"SEARCH_FIELD":"os_actor_process_signature_status","SEARCH_TYPE":"COMPLEX_EQ","SEARCH_VALUE":"{\"COLLECTION_TYPE\": \"SIGNATURE_STATUS\", \"COLLECTION_VALUE\": \"SIGNATURE_SIGNED\"}","isExtended":true,"node":"xdr_actor"}]},{"SEARCH_FIELD":"action_process_image_name","SEARCH_TYPE":"REGEX","SEARCH_VALUE":".dll","EXTRA_FIELDS":[],"isExtended":false,"node":"attributes"},{"OR":[{"SEARCH_FIELD":"actor_process_image_name","SEARCH_TYPE":"REGEX","SEARCH_VALUE":".exe","EXTRA_FIELDS":["causality_actor_process_image_name","os_actor_process_image_name"],"isExtended":false,"node":"xdr_actor"},{"SEARCH_FIELD":"causality_actor_process_image_name","SEARCH_TYPE":"REGEX","SEARCH_VALUE":".exe","isExtended":true,"node":"xdr_actor"},{"SEARCH_FIELD":"os_actor_process_image_name","SEARCH_TYPE":"REGEX","SEARCH_VALUE":".exe","isExtended":true,"node":"xdr_actor"}]},{"SEARCH_FIELD":"agent_os_type","SEARCH_TYPE":"EQ","SEARCH_VALUE":1,"EXTRA_FIELDS":[],"isExtended":false,"node":"xdr_agent"}]}}}},"indicator_md5":"90261ec42362437c0d7adf42f776675d","indicator_text":"Process action type = execution AND target process name =~ .dll AND process execution signature = Unsigned Process initiator signature = Signed, cgo signature = Signed, os parent signature = Signed AND initiated by =~ .exe, cgo name =~ .exe, os parent name =~ .exe Host host os != linux AND host os = windows","name":"Signed EXE launches unsigned DLL","mitre_technique_id_and_name":"T1073 - DLL Side-Loading|T1038 - DLL Search Order Hijacking","mitre_tactic_id_and_name":"TA0002 - Execution","mitre_tactic_id":"TA0002","mitre_technique_id":"T1073|T1038","btp_rule":{"AGENT_OS_WINDOWS":{"signatureConfiguration":{"default":{"settings":{"action":"block","friendlyName":"Signed EXE launches unsigned DLL","tactic_id":["TA0002"],"technique_id":["T1073","T1038"],"biocRuleName":"Signed EXE launches unsigned DLL","biocId":489,"additionalData":"{}"}}},"rule_data":"(deftemplate process_start_489 (slot cid)) (defrule process_start_489 (process_start (process_image_name ?act_process_image_name) (cid ?cid) (instance_id ?parent_instance_id) (is_sign ?act_is_sign &: (or (eq ?act_is_sign ?*signature_state_signed*) (regex ?act_process_image_name \".exe\" 0)))) (process_start (is_sign ?is_sign) (instance_id ?instance_id) (parent_instance_id ?act_parent_instance_id) (os_parent_instance_id ?os_act_parent_instance_id) (cid ?cid) (process_image_name ?process_image_name &: (and (eq ?is_sign ?*signature_state_unsigned*) (and (eq ?act_is_sign ?*signature_state_signed*) (eq ?act_parent_instance_id ?parent_instance_id)) (regex ?process_image_name \".dll\" 0) (and (regex ?act_process_image_name \".exe\" 0) (eq ?act_parent_instance_id ?parent_instance_id))))) (not (process_start_489 (cid ?cid))) => (assert (process_start_489 (cid ?cid))))"}},"btp_rule_name":"process_start_489","is_preventable":1,"supported_os":1,"btp_validation_error":"WINDOWS_SUPPORT_ONLY","xql":null,"is_xql":false,"query_tables":null,"rule_indicator_last_modified_ts":1625470742422}]